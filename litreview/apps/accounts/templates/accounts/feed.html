{% extends 'main.html' %}

{% block content %}

{% if request.user.is_authenticated %}
<div>
  <a class="button is-light" href="/create-ticket">New ticket</a>
  <a class="button is-light" href="/create-review">Create review</a>
</div>
{% endif %}

{% for post in posts %}

  {% if post.content_type == 'TICKET' %}
    <div class="card post">
      <h3 class="message-header">Ticket from {{post.user}}</h3>
      <div class="book-title">
        <h3 class="card-header-title">{{post.title}}</h3>
      </div>
      <div class="card-content">
        <p>{{post.description}}</p>
        <img class="book-image" src="https://via.placeholder.com/128x192">
      </div>

      <div class="card-date">
        <time>{{post.time_created}}</time>
        {% if request.user.username == post.user.username %}
        <a class="button is-danger is-light is-small" href="{% url 'delete-ticket' post.id %}">Delete</a>
        <button class="button is-light is-small">Create review</button>
        {% endif %}
      </div>

    </div>

  {% elif post.content_type == 'REVIEW' %}
    <div class="card post">
      <h3 class="message-header">Review by {{post.user}}</h3>
      <div class="book-title">
        <h3 class="card-header-title">{{post.ticket}}</h3>
        <img class="book-image" src="https://via.placeholder.com/128x192">
        <p class="is-italic">{{post.headline}}</p>
      </div>

      <div class="card-content">
        <p>{{post.body}}</p>
      </div>

      <div class="card-date">
        <time>{{post.time_created}}</time>
        {% if request.user.username == post.user.username %}
        <a class="button is-danger is-light is-small" href="{% url 'delete-review' post.id %}">Delete</a>
        {% endif %}
      </div>

    </div>

  {% endif %}

{% endfor %}

{% endblock content %}

